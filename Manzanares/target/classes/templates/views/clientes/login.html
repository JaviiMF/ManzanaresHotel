<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="plantillas/template :: head">
	<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
</head>

<body>
	<header th:replace="plantillas/template :: header">
		<h1 class="text-center">Inicia Sesión</h1>
	</header>

	<div class="container">

		<div class="text-center pt-4">
			<strong>Inicia Sesión / Regístrate</strong>
			<p>Ya seas cliente o miembro del staff, inicia sesión para
				acceder a todos tus datos.</p>
		</div>

		<form class="form-horizontal" onsubmit="return validarFormulario()">
			<!-- Iniciar Sesión Form -->
			<div class="form-group text-center">
				<h2>Iniciar Sesión</h2>
				<div class="form-group">
					<label for="loginEmail">Email</label> <input type="email"
						class="form-control" id="loginEmail" aria-describedby="emailHelp"
						placeholder="Email" required>
				</div>

				<div class="form-group">
					<label for="loginPassword">Contraseña</label> <input
						type="password" class="form-control" id="loginPassword"
						placeholder="Contraseña" required>
				</div>
				<button type="submit" class="btn btn-primary mt-3">Login</button>
			</div>
		</form>

		<script>
			function validarFormulario() {
				var email = $("#loginEmail").val();
				var password = $("#loginPassword").val();

				if (email === "" || password === "") {
					alert("Por favor, complete todos los campos.");
					return false;
				}

				// Llama a la función de login utilizando AJAX y jQuery
				login(email, password);

				return false; // Evita que el formulario se envíe automáticamente.
			}

			function login(usuario, pass) {
				var requestData = {
					"usuario": usuario,
					"pass": pass
				};

				$.ajax({
					type: "POST",
					url: "/customer/login",
					contentType: "application/json",
					data: JSON.stringify(requestData),
					success: function (response) {
						if (response) {
							alert("Login exitoso");
							// Puedes redirigir a otra página o hacer algo más después del login exitoso
						} else {
							alert("Login fallido");
						}
					},
					error: function (error) {
						console.error("Error en la petición:", error);
					}
				});
			}
		</script>

		<form class="form-horizontal mt-4" onsubmit="return validarRegistro()">
			<!-- Registrarse Form -->
			<div class="form-group text-center">
				<h2>Registrarse</h2>
				<div class="row">
					<div class="col-md-6">
						<label for="regNombre">Nombre</label> <input type="text"
							class="form-control" id="regNombre" placeholder="Nombre" required>
					</div>
					<div class="col-md-6">
						<label for="regApellidos">Apellidos</label> <input type="text"
							class="form-control" id="regApellidos" placeholder="Apellidos"
							required>
					</div>
				</div>
				<div class="row">
					<div class="col-md-6">
						<label for="regNIF">NIF</label> <input type="text"
							class="form-control" id="regNIF" placeholder="NIF" required>
					</div>
					<div class="col-md-6">
						<label for="regNacimiento">Fecha Nacimiento</label> <input
							type="date" class="form-control" id="regNacimiento" required>
					</div>
				</div>
				<div class="row">
					<div class="col-md-6">
						<label for="regPassword">Contraseña</label> <input type="password"
							class="form-control" id="regPassword" placeholder="Contraseña"
							required>
					</div>
					<div class="col-md-6">
						<label for="regConfirmPassword">Confirmar Contraseña</label> <input
							type="password" class="form-control" id="regConfirmPassword"
							placeholder="Confirmar Contraseña" required>
					</div>
				</div>
				<div class="row">
					<div class="col-md-6">
						<label for="regEmail">Email</label> <input type="email"
							class="form-control" id="regEmail" placeholder="Email" required>
					</div>
					<div class="col-md-6">
						<label for="regTlf">Teléfono</label> <input type="tel"
							class="form-control" id="regTlf" placeholder="Teléfono" required>
					</div>
				</div>
				<div class="row">
					<div class="col-md-6">
						<label for="regPais">País</label> <select class="form-control"
							id="regPais" required>
							<option>España</option>
							<option>Italia</option>
							<option>Francia</option>
							<option>Portugal</option>
						</select>
					</div>
					<div class="col-md-6">
						<label for="regGenero">Género</label> <select class="form-control"
							id="regGenero" required>
							<option>Male</option>
							<option>Female</option>
							<option>Other</option>
						</select>
					</div>
				</div>
				<div class="form-check mt-2">
					<input type="checkbox" class="form-check-input"
						id="terminosCondiciones" required> <label
						class="form-check-label" for="terminosCondiciones">Acepto
						términos y condiciones</label>
				</div>
				<div class="form-check">
					<input type="checkbox" class="form-check-input"
						id="recibirNotificaciones"> <label
						class="form-check-label" for="recibirNotificaciones">Deseo
						recibir notificaciones</label>
				</div>
				<button type="button" class="btn btn-primary mt-3 mb-3" onclick="validarRegistro()">Darse de alta</button>
			</div>
		</form>

		<script>
    function validarRegistro() {
        // Puedes personalizar la función de validación según tus necesidades.
        var nombre = document.getElementById("regNombre").value;
        var apellidos = document.getElementById("regApellidos").value;
        var nif = document.getElementById("regNIF").value;
        var nacimiento = document.getElementById("regNacimiento").value;
        var password = document.getElementById("regPassword").value;
        var confirmPassword = document.getElementById("regConfirmPassword").value;
        var email = document.getElementById("regEmail").value;
        var telefono = document.getElementById("regTlf").value;
        var pais = document.getElementById("regPais").value;
        var genero = document.getElementById("regGenero").value;
        var terminosCondiciones = document.getElementById("terminosCondiciones").checked;

        if (nombre === "" || apellidos === "" || nif === "" || nacimiento === "" || password === "" || confirmPassword === "" || email === "" || telefono === "" || pais === "" || genero === "" || !terminosCondiciones) {
            alert("Por favor, complete todos los campos obligatorios.");
            return false;
        }

        // Crear un objeto Usuario con los datos del formulario
		var usuario = {
			email: email,
			contrasena: password,
			nombre: nombre,
			telefono: telefono,
			dni: nif,
			tipo: "cliente"
		}

		// Realizar la solicitud POST utilizando fetch
		fetch('/customer/createUsuario', {
			method: 'POST',
			headers: {
				'Content-Type': 'application/json',
			},
			body: JSON.stringify(usuario),
		})
				.then(response => response.json())
				.then(data => {
					// Aquí puedes manejar la respuesta del servidor después de crear el usuario
					console.log('Usuario creado con éxito:', data);
					alert('Usuario creado con éxito');
				})
				.catch(error => {
					console.error('Error al crear el usuario:', error);
					alert('Error al crear el usuario');
				});

        return false; // Evita que el formulario se envíe automáticamente
    }
</script>

	</div>

	<footer th:replace="plantillas/template :: footer"></footer>
</body>

</html>
